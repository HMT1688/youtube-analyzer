<!-- ================================================================= -->
<!-- 1. templates/analyze.html íŒŒì¼ì˜ ë‚´ìš©ì„ ì•„ë˜ ì½”ë“œë¡œ êµì²´í•´ì£¼ì„¸ìš”. -->
<!-- ================================================================= -->

<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ stats.title }} - ì±„ë„ ë¶„ì„ ê²°ê³¼</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .page-link.active {
            z-index: 10;
            color: #fff;
            background-color: #ef4444; /* red-500 */
            border-color: #ef4444;
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-800 font-sans">
    <div class="relative flex justify-center min-h-screen">
        <!-- ì™¼ìª½ ê´‘ê³  ë°°ë„ˆ -->
        <aside class="hidden xl:block w-48 flex-shrink-0 p-4">
            <div class="sticky top-8 bg-white h-96 rounded-lg shadow-md flex items-center justify-center text-gray-400 border">
                <span>ì—¬ê¸°ì— ê´‘ê³ </span>
            </div>
        </aside>

        <!-- ë©”ì¸ ì½˜í…ì¸  ì˜ì—­ -->
        <main class="w-full max-w-7xl p-4 md:p-8">
            <div class="mb-6">
                <a href="/" class="text-red-600 hover:text-red-800 transition-colors">&larr; ë‹¤ë¥¸ ì±„ë„ ë¶„ì„í•˜ê¸°</a>
            </div>
            
            <!-- ì±„ë„ ê¸°ë³¸ ì •ë³´ -->
            <header class="bg-white p-6 rounded-lg shadow-lg mb-8 flex flex-col md:flex-row items-center space-y-4 md:space-y-0 md:space-x-8">
                <img src="{{ stats.profile_image }}" alt="{{ stats.title }} í”„ë¡œí•„" class="w-32 h-32 rounded-full border-4 border-red-200">
                <div class="flex-1 text-center md:text-left">
                    <h1 class="text-4xl font-bold text-gray-800">{{ stats.title }}</h1>
                    <p class="text-gray-500 mt-2 max-w-2xl line-clamp-3">{{ stats.description }}</p>
                </div>
            </header>
            
            <!-- ì±„ë„ ìš”ì•½ í†µê³„ -->
            <section class="grid grid-cols-2 md:grid-cols-4 gap-4 md:gap-6 mb-10 text-center">
                <div class="bg-white p-5 rounded-lg shadow-lg"><div class="text-sm text-gray-500">êµ¬ë…ì ìˆ˜</div><div class="text-3xl font-bold text-red-600 mt-1">{{ "{:,}".format(stats.subscribers) }}ëª…</div></div>
                <div class="bg-white p-5 rounded-lg shadow-lg"><div class="text-sm text-gray-500">ì´ ì¡°íšŒìˆ˜</div><div class="text-3xl font-bold text-red-600 mt-1">{{ "{:,}".format(stats.total_views) }}íšŒ</div></div>
                <div class="bg-white p-5 rounded-lg shadow-lg"><div class="text-sm text-gray-500">ì´ ì˜ìƒ ìˆ˜</div><div class="text-3xl font-bold text-red-600 mt-1">{{ "{:,}".format(stats.video_count) }}ê°œ</div></div>
                <div class="bg-white p-5 rounded-lg shadow-lg"><div class="text-sm text-gray-500">ì±„ë„ ê°œì„¤ì¼</div><div class="text-3xl font-bold text-red-600 mt-1">{{ stats.created_date }}</div></div>
            </section>

            <!-- ì±„ë„ ì‹¬ì¸µ ë¶„ì„ -->
            <section class="mb-12">
                <h2 class="text-3xl font-bold mb-6 text-gray-700 border-l-4 border-red-500 pl-4">ì±„ë„ ì‹¬ì¸µ ë¶„ì„ (ìµœê·¼ 200ê°œ ì˜ìƒ ê¸°ì¤€)</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                    <div class="bg-white p-6 rounded-lg shadow-lg">
                        <h3 class="font-bold text-lg mb-3 text-gray-600">ì½˜í…ì¸  ê¾¸ì¤€í•¨</h3>
                        <div class="space-y-2">
                            <p><strong>ì£¼ê°„ í‰ê·  ì—…ë¡œë“œ:</strong> <span class="font-semibold text-xl text-blue-600">{{ analysis.uploads_per_week }}ê°œ</span></p>
                            <p><strong>í‰ê·  ì˜ìƒ ê¸¸ì´:</strong> <span class="font-semibold text-xl text-blue-600">{{ analysis.avg_duration }}</span></p>
                        </div>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-lg">
                        <h3 class="font-bold text-lg mb-3 text-gray-600">ì‹œì²­ì ì°¸ì—¬ë„</h3>
                        <div class="space-y-2">
                            <p><strong>1ì²œë·° ë‹¹ ì¢‹ì•„ìš”:</strong> <span class="font-semibold text-xl text-green-600">{{ analysis.likes_per_1000_views }}ê°œ</span></p>
                            <p><strong>1ì²œë·° ë‹¹ ëŒ“ê¸€:</strong> <span class="font-semibold text-xl text-green-600">{{ analysis.comments_per_1000_views }}ê°œ</span></p>
                        </div>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-lg md:col-span-2">
                        <h3 class="font-bold text-lg mb-3 text-gray-600">ìµœê·¼ ì¸ê¸° TOP 5</h3>
                        <ul class="space-y-2">
                            {% for video in analysis.top_5_videos %}
                            <li class="truncate"><a href="{{ video.url }}" target="_blank" class="hover:text-red-500 transition-colors">ğŸ† {{ video.title }} ({{ "{:,}".format(video.views) }}íšŒ)</a></li>
                            {% endfor %}
                        </ul>
                    </div>
                </div>
            </section>

            <!-- ë™ì˜ìƒ ëª©ë¡ -->
            <section>
                <h2 class="text-3xl font-bold mb-6 text-gray-700 border-l-4 border-red-500 pl-4">ë™ì˜ìƒ ëª©ë¡</h2>
                <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6">
                    {% for v in videos %}
                    <div class="bg-white rounded-lg shadow-lg overflow-hidden flex flex-col group transform hover:-translate-y-1 transition-transform duration-300">
                        <a href="{{ v.url }}" target="_blank" class="block overflow-hidden"><img src="{{ v.thumb }}" alt="{{ v.title }}" class="w-full h-40 object-cover group-hover:scale-110 transition-transform duration-300"></a>
                        <div class="p-4 flex flex-col flex-grow">
                            <h3 class="font-bold text-md mb-2 flex-grow h-12 line-clamp-2">{{ v.title }}</h3>
                            <div class="text-sm text-gray-600 space-y-1 mb-3">
                                <p>ì¡°íšŒìˆ˜: <span class="font-medium">{{ "{:,}".format(v.views) }}íšŒ</span></p>
                                <p>ì¢‹ì•„ìš”: <span class="font-medium">{{ "{:,}".format(v.likes) }}ê°œ</span></p>
                                <p>ì—…ë¡œë“œ: <span class="font-medium">{{ v.published.date() }}</span></p>
                            </div>
                            <!-- âœ¨ ë²„íŠ¼ ë§í¬ ìˆ˜ì • âœ¨ -->
                            <div class="mt-auto pt-3 border-t border-gray-200 text-center text-xs space-x-2 font-semibold">
                                 <a href="/view-caption/{{ v.id }}" target="_blank" class="text-blue-600 hover:underline">ìë§‰ ë³´ê¸°</a><span>|</span>
                                 <a href="/caption-ai/{{ v.id }}" class="text-purple-600 hover:underline">AIìë§‰</a><span>|</span>
                                 <a href="/download-video/{{ v.id }}" class="text-green-600 hover:underline">ë‹¤ìš´</a><span>|</span>
                                 <a href="{{ v.url }}" target="_blank" class="text-red-600 hover:underline">ë³´ê¸°</a>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </section>

            <!-- í˜ì´ì§€ë„¤ì´ì…˜ ë²„íŠ¼ -->
            <nav class="mt-10 flex justify-center">
                <ul class="inline-flex items-center -space-x-px">
                    {% set start_page = [1, current_page - 4] | max %}
                    {% set end_page = [total_pages, current_page + 4] | min %}
                    {% if current_page > 1 %}
                    <li><a href="/analyze?url={{ original_url }}&page={{ current_page - 1 }}" class="py-2 px-3 ml-0 leading-tight text-gray-500 bg-white rounded-l-lg border border-gray-300 hover:bg-gray-100 hover:text-gray-700">ì´ì „</a></li>
                    {% endif %}
                    {% for p in range(start_page, end_page + 1) %}
                    <li><a href="/analyze?url={{ original_url }}&page={{ p }}" class="page-link py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 {% if p == current_page %}active{% endif %}">{{ p }}</a></li>
                    {% endfor %}
                    {% if current_page < total_pages %}
                    <li><a href="/analyze?url={{ original_url }}&page={{ current_page + 1 }}" class="py-2 px-3 leading-tight text-gray-500 bg-white rounded-r-lg border border-gray-300 hover:bg-gray-100 hover:text-gray-700">ë‹¤ìŒ</a></li>
                    {% endif %}
                </ul>
            </nav>
        </main>

        <!-- ì˜¤ë¥¸ìª½ ê´‘ê³  ë°°ë„ˆ -->
        <aside class="hidden xl:block w-48 flex-shrink-0 p-4">
            <div class="sticky top-8 bg-white h-96 rounded-lg shadow-md flex items-center justify-center text-gray-400 border">
                <span>ì—¬ê¸°ì— ê´‘ê³ </span>
            </div>
        </aside>
    </div>
</body>
</html>

<!-- =================================================================== -->
<!-- 2. templates/view_caption.html íŒŒì¼ì„ ìƒˆë¡œ ë§Œë“¤ê³  ì•„ë˜ ì½”ë“œë¥¼ ë¶™ì—¬ë„£ì–´ì£¼ì„¸ìš”. -->
<!-- =================================================================== -->

<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ìë§‰ ë³´ê¸°: {{ title }}</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 text-gray-800 font-sans">
    <div class="container mx-auto max-w-4xl p-4 md:p-8">
        <h1 class="text-2xl md:text-3xl font-bold text-gray-800 mb-2 truncate">{{ title }}</h1>
        <p class="text-gray-500 mb-6">ìë§‰ (SRT í˜•ì‹)</p>

        <div class="bg-white p-4 sm:p-6 rounded-lg shadow-lg">
            <!-- pre íƒœê·¸ëŠ” í…ìŠ¤íŠ¸ì˜ ì¤„ë°”ê¿ˆê³¼ ë„ì–´ì“°ê¸°ë¥¼ ê·¸ëŒ€ë¡œ ë³´ì—¬ì¤ë‹ˆë‹¤. -->
            <pre class="text-sm md:text-base whitespace-pre-wrap break-words">{{ srt_content }}</pre>
        </div>

        <div class="mt-8 text-center">
            <button onclick="window.close()" class="bg-red-500 text-white font-bold py-2 px-6 rounded-lg hover:bg-red-600 transition-colors">
                ì°½ ë‹«ê¸°
            </button>
        </div>
    </div>
</body>
</html>
